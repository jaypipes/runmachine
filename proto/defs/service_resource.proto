syntax = "proto3";

package runm;

import "consumer.proto";
import "distance.proto";
import "error.proto";
import "inventory.proto";
import "project.proto";
import "provider.proto";
import "resource_class.proto";
import "search.proto";
import "session.proto";
import "trait.proto";
import "user.proto";
import "wrappers.proto";

// The runm-resource gRPC service manages inventory of the deployment's set of
// resource providers, the transactional claims of resources, basic scheduling
// and reservations.
service RunmResource {
    // Returns information about a specific resource class
    rpc resource_class_get(ResourceClassGetRequest) returns (ResourceClass) {}

    // Deletes one or more resource classes
    rpc resource_class_delete(ResourceClassDeleteRequest) returns (ResourceClassDeleteResponse) {}

    // Set information about a specific resource class
    rpc resource_class_set(ResourceClassSetRequest) returns (ResourceClassSetResponse) {}

    // Returns information about multiple resource classs
    rpc resource_class_list(ResourceClassListRequest) returns (stream ResourceClass) {}

    // Returns information about a specific trait
    rpc trait_get(TraitGetRequest) returns (Trait) {}

    // Deletes one or more traits
    rpc trait_delete(TraitDeleteRequest) returns (TraitDeleteResponse) {}

    // Set information about a specific trait
    rpc trait_set(TraitSetRequest) returns (TraitSetResponse) {}

    // Returns information about multiple traits
    rpc trait_list(TraitListRequest) returns (stream Trait) {}

    // Returns information about a specific consumer type
    rpc consumer_type_get(ConsumerTypeGetRequest) returns (ConsumerType) {}

    // Deletes one or more consumer typees
    rpc consumer_type_delete(ConsumerTypeDeleteRequest) returns (ConsumerTypeDeleteResponse) {}

    // Set information about a specific consumer type
    rpc consumer_type_set(ConsumerTypeSetRequest) returns (ConsumerTypeSetResponse) {}

    // Returns information about multiple consumer types
    rpc consumer_type_list(ConsumerTypeListRequest) returns (stream ConsumerType) {}

    // Returns information about a specific consumer type
    rpc consumer_get(ConsumerGetRequest) returns (Consumer) {}

    // Deletes one or more consumer typees
    rpc consumer_delete(ConsumerDeleteRequest) returns (ConsumerDeleteResponse) {}

    // Set information about a specific consumer type
    rpc consumer_set(ConsumerSetRequest) returns (ConsumerSetResponse) {}

    // Returns information about multiple consumer types
    rpc consumer_list(ConsumerListRequest) returns (stream Consumer) {}

    // Returns information about a specific distance type
    rpc distance_type_get(DistanceTypeGetRequest) returns (DistanceType) {}

    // Deletes one or more distance typees
    rpc distance_type_delete(DistanceTypeDeleteRequest) returns (DistanceTypeDeleteResponse) {}

    // Set information about a specific distance type
    rpc distance_type_set(DistanceTypeSetRequest) returns (DistanceTypeSetResponse) {}

    // Returns information about multiple distance types
    rpc distance_type_list(DistanceTypeListRequest) returns (stream DistanceType) {}

    // Returns information about a specific distance
    rpc distance_get(DistanceGetRequest) returns (Distance) {}

    // Deletes one or more distancees
    rpc distance_delete(DistanceDeleteRequest) returns (DistanceDeleteResponse) {}

    // Set information about a specific distance
    rpc distance_set(DistanceSetRequest) returns (DistanceSetResponse) {}

    // Returns information about multiple distances
    rpc distance_list(DistanceListRequest) returns (stream Distance) {}

    // Returns information about a specific provider
    rpc provider_get(ProviderGetRequest) returns (Provider) {}

    // Deletes one or more providers
    rpc provider_delete(ProviderDeleteRequest) returns (ProviderDeleteResponse) {}

    // Set information about a specific provider
    rpc provider_set(ProviderSetRequest) returns (ProviderSetResponse) {}

    // Returns information about multiple providers
    rpc provider_list(ProviderListRequest) returns (stream Provider) {}

    // Add or remove traits from a provider
    rpc provider_traits_set(ProviderTraitsSetRequest) returns (ProviderTraitsSetResponse) {}

    // Add, remove and modify inventories for a provider
    rpc provider_inventories_set(ProviderInventoriesSetRequest) returns (ProviderInventoriesSetResponse) {}

    // Returns information about a specific provider group
    rpc provider_group_get(ProviderGroupGetRequest) returns (ProviderGroup) {}

    // Deletes one or more provider groups
    rpc provider_group_delete(ProviderGroupDeleteRequest) returns (ProviderGroupDeleteResponse) {}

    // Set information about a specific provider group
    rpc provider_group_set(ProviderGroupSetRequest) returns (ProviderGroupSetResponse) {}

    // Returns information about multiple provider groups
    rpc provider_group_list(ProviderGroupListRequest) returns (stream ProviderGroup) {}

    // Add or remove providers from a provider group
    rpc provider_group_members_set(ProviderGroupMembersSetRequest) returns (ProviderGroupMembersSetResponse) {}

    // List providers belonging to a provider group
    rpc provider_group_members_list(ProviderGroupMembersListRequest) returns (stream Provider) {}

    // Add or remove distances between othe provider groups from a provider group
    rpc provider_group_distances_set(ProviderGroupDistancesSetRequest) returns (ProviderGroupDistancesSetResponse) {}

    // List provider-group-distance records for a provider group
    rpc provider_group_distances_list(ProviderGroupDistancesListRequest) returns (stream ProviderGroupDistance) {}
}

// RPC Request payload messages
message ResourceClassGetRequest {
    Session session = 1;
    string search = 2;
}

message ResourceClassSetFields {
    StringValue code = 1;
    StringValue display_name = 2;
    StringValue description = 3;
}

message ResourceClassSetRequest {
    Session session = 1;
    ResourceClass resource_class = 2;
    ResourceClassSetFields changed = 3;
}

message ResourceClassSetResponse {
    repeated Error errors = 1;
    ResourceClass resource_class = 2;
}

message ResourceClassListFilters {
    repeated string identifiers = 1;
}

message ResourceClassListRequest {
    Session session = 1;
    ResourceClassListFilters filters = 2;
    SearchOptions options = 3;
}

message ResourceClassDeleteRequest {
    Session session = 1;
    repeated ResourceClass resource_classes = 2;
}

message ResourceClassDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message TraitGetRequest {
    Session session = 1;
    string search = 2;
}

message TraitSetFields {
    StringValue code = 1;
    StringValue display_name = 2;
    StringValue description = 3;
}

message TraitSetRequest {
    Session session = 1;
    Trait trait = 2;
    TraitSetFields changed = 3;
}

message TraitSetResponse {
    repeated Error errors = 1;
    Trait trait = 2;
}

message TraitListFilters {
    repeated string identifiers = 1;
}

message TraitListRequest {
    Session session = 1;
    TraitListFilters filters = 2;
    SearchOptions options = 3;
}

message TraitDeleteRequest {
    Session session = 1;
    repeated Trait traits = 2;
}

message TraitDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message ConsumerGetRequest {
    Session session = 1;
    string search = 2;
}

message ConsumerSetFields {
    StringValue display_name = 1;
    ConsumerType type = 50;
    Project project = 51;
    User user = 52;
}

message ConsumerSetRequest {
    Session session = 1;
    Consumer consumer = 2;
    ConsumerSetFields changed = 3;
}

message ConsumerSetResponse {
    repeated Error errors = 1;
    Consumer consumer = 2;
}

message ConsumerListFilters {
    repeated string identifiers = 1;
    repeated string type_identifiers = 2;
    repeated string project_identifiers = 3;
    repeated string user_identifiers = 4;
}

message ConsumerListRequest {
    Session session = 1;
    ConsumerListFilters filters = 2;
    SearchOptions options = 3;
}

message ConsumerDeleteRequest {
    Session session = 1;
    repeated Consumer consumers = 2;
}

message ConsumerDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message ConsumerTypeGetRequest {
    Session session = 1;
    string search = 2;
}

message ConsumerTypeSetFields {
    StringValue code = 1;
    StringValue display_name = 2;
    StringValue description = 3;
}

message ConsumerTypeSetRequest {
    Session session = 1;
    ConsumerType consumer_type = 2;
    ConsumerTypeSetFields changed = 3;
}

message ConsumerTypeSetResponse {
    repeated Error errors = 1;
    ConsumerType consumer_type = 2;
}

message ConsumerTypeListFilters {
    repeated string identifiers = 1;
}

message ConsumerTypeListRequest {
    Session session = 1;
    ConsumerTypeListFilters filters = 2;
    SearchOptions options = 3;
}

message ConsumerTypeDeleteRequest {
    Session session = 1;
    repeated ConsumerType consumer_types = 2;
}

message ConsumerTypeDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message DistanceTypeGetRequest {
    Session session = 1;
    string search = 2;
}

message DistanceTypeSetFields {
    StringValue code = 1;
    StringValue display_name = 2;
    StringValue description = 3;
}

message DistanceTypeSetRequest {
    Session session = 1;
    DistanceType distance_type = 2;
    DistanceTypeSetFields changed = 3;
}

message DistanceTypeSetResponse {
    repeated Error errors = 1;
    DistanceType distance_type = 2;
}

message DistanceTypeListFilters {
    repeated string identifiers = 1;
}

message DistanceTypeListRequest {
    Session session = 1;
    DistanceTypeListFilters filters = 2;
    SearchOptions options = 3;
}

message DistanceTypeDeleteRequest {
    Session session = 1;
    repeated DistanceType distance_types = 2;
}

message DistanceTypeDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message DistanceGetRequest {
    Session session = 1;
    string search = 2;
}

message DistanceSetFields {
    StringValue code = 1;
    StringValue display_name = 2;
    UInt32Value position = 3;
    DistanceType type = 50;
}

message DistanceSetRequest {
    Session session = 1;
    Distance distance = 2;
    DistanceSetFields changed = 3;
}

message DistanceSetResponse {
    repeated Error errors = 1;
    Distance distance = 2;
}

message DistanceListFilters {
    repeated string identifiers = 1;
    repeated string type_identifiers = 2;
}

message DistanceListRequest {
    Session session = 1;
    DistanceListFilters filters = 2;
    SearchOptions options = 3;
}

message DistanceDeleteRequest {
    Session session = 1;
    repeated Distance distances = 2;
}

message DistanceDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message ProviderGetRequest {
    Session session = 1;
    string search = 2;
}

message ProviderSetFields {
    StringValue display_name = 1;
    Provider parent = 2;
}

message ProviderSetRequest {
    Session session = 1;
    Provider provider = 2;
    ProviderSetFields changed = 3;
}

message ProviderSetResponse {
    repeated Error errors = 1;
    Provider provider = 2;
}

message ProviderListFilters {
    repeated string identifiers = 1;
}

message ProviderListRequest {
    Session session = 1;
    ProviderListFilters filters = 2;
    SearchOptions options = 3;
}

message ProviderDeleteRequest {
    Session session = 1;
    repeated Provider providers = 2;
}

message ProviderDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message ProviderTraitsSetRequest {
    Session session = 1;
    Provider provider = 2;
    repeated string add = 3;
    repeated string remove = 4;
}

message ProviderTraitsSetResponse {
    repeated Error errors = 1;
    Provider provider = 2;
    uint64 num_added = 3;
    uint64 num_removed = 4;
}

message ProviderInventoriesSetRequest {
    Session session = 1;
    Provider provider = 2;
    repeated Inventory add = 3;
    repeated Inventory remove = 4;
    repeated Inventory modify = 5;
}

message ProviderInventoriesSetResponse {
    repeated Error errors = 1;
    Provider provider = 2;
    uint64 num_added = 3;
    uint64 num_removed = 4;
    uint64 num_modified = 5;
}

message ProviderGroupGetRequest {
    Session session = 1;
    string search = 2;
}

message ProviderGroupSetFields {
    StringValue display_name = 1;
}

message ProviderGroupSetRequest {
    Session session = 1;
    ProviderGroup provider_group = 2;
    ProviderGroupSetFields changed = 3;
}

message ProviderGroupSetResponse {
    repeated Error errors = 1;
    ProviderGroup provider_group = 2;
}

message ProviderGroupListFilters {
    repeated string identifiers = 1;
}

message ProviderGroupListRequest {
    Session session = 1;
    ProviderGroupListFilters filters = 2;
    SearchOptions options = 3;
}

message ProviderGroupDeleteRequest {
    Session session = 1;
    repeated ProviderGroup provider_groups = 2;
}

message ProviderGroupDeleteResponse {
    repeated Error errors = 1;
    uint64 num_deleted = 2;
}

message ProviderGroupMembersSetRequest {
    Session session = 1;
    ProviderGroup provider_group = 2;
    repeated string add = 3;
    repeated string remove = 4;
}

message ProviderGroupMembersSetResponse {
    repeated Error errors = 1;
    ProviderGroup provider_group = 2;
    uint64 num_added = 3;
    uint64 num_removed = 4;
}

message ProviderGroupMembersListRequest {
    Session session = 1;
    ProviderGroup provider_group = 2;
}

message ProviderGroupDistancesSetRequest {
    Session session = 1;
    ProviderGroup provider_group = 2;
    repeated ProviderGroupDistance add = 3;
    repeated ProviderGroupDistance remove = 4;
    repeated ProviderGroupDistance modify = 5;
}

message ProviderGroupDistancesSetResponse {
    repeated Error errors = 1;
    ProviderGroup provider_group = 2;
    uint64 num_added = 3;
    uint64 num_removed = 4;
    uint64 num_modified = 5;
}

message ProviderGroupDistancesListRequest {
    Session session = 1;
    ProviderGroup provider_group = 2;
}
